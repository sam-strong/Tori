<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Net::SSH::KeyFactory</title>

  <link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../lib/net/ssh/key_factory_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/net/ssh/key_factory.rb">lib/net/ssh/key_factory.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-get">::get</a></li>
          
          <li><a href="#method-c-load_data_private_key">::load_data_private_key</a></li>
          
          <li><a href="#method-c-load_data_public_key">::load_data_public_key</a></li>
          
          <li><a href="#method-c-load_private_key">::load_private_key</a></li>
          
          <li><a href="#method-c-load_public_key">::load_public_key</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><span class="include">Prompt</span></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../LICENSE_txt.html">LICENSE.txt</a></li>
        
          <li class="file"><a href="../../README_rdoc.html">README.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../Net.html">Net</a></li>
        
          <li><a href="../../Net/SSH.html">Net::SSH</a></li>
        
          <li><a href="../../Net/SSH/Authentication.html">Net::SSH::Authentication</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Agent.html">Net::SSH::Authentication::Agent</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Agent/Comment.html">Net::SSH::Authentication::Agent::Comment</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Agent/Key.html">Net::SSH::Authentication::Agent::Key</a></li>
        
          <li><a href="../../Net/SSH/Authentication/AgentError.html">Net::SSH::Authentication::AgentError</a></li>
        
          <li><a href="../../Net/SSH/Authentication/AgentNotAvailable.html">Net::SSH::Authentication::AgentNotAvailable</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Constants.html">Net::SSH::Authentication::Constants</a></li>
        
          <li><a href="../../Net/SSH/Authentication/DisallowedMethod.html">Net::SSH::Authentication::DisallowedMethod</a></li>
        
          <li><a href="../../Net/SSH/Authentication/KeyManager.html">Net::SSH::Authentication::KeyManager</a></li>
        
          <li><a href="../../Net/SSH/Authentication/KeyManagerError.html">Net::SSH::Authentication::KeyManagerError</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods.html">Net::SSH::Authentication::Methods</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/Abstract.html">Net::SSH::Authentication::Methods::Abstract</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/Hostbased.html">Net::SSH::Authentication::Methods::Hostbased</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/KeyboardInteractive.html">Net::SSH::Authentication::Methods::KeyboardInteractive</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/None.html">Net::SSH::Authentication::Methods::None</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/Password.html">Net::SSH::Authentication::Methods::Password</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Methods/Publickey.html">Net::SSH::Authentication::Methods::Publickey</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Pageant.html">Net::SSH::Authentication::Pageant</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Pageant/Socket.html">Net::SSH::Authentication::Pageant::Socket</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Pageant/Socket19.html">Net::SSH::Authentication::Pageant::Socket19</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Pageant/Win.html">Net::SSH::Authentication::Pageant::Win</a></li>
        
          <li><a href="../../Net/SSH/Authentication/Session.html">Net::SSH::Authentication::Session</a></li>
        
          <li><a href="../../Net/SSH/AuthenticationFailed.html">Net::SSH::AuthenticationFailed</a></li>
        
          <li><a href="../../Net/SSH/Buffer.html">Net::SSH::Buffer</a></li>
        
          <li><a href="../../Net/SSH/BufferedIo.html">Net::SSH::BufferedIo</a></li>
        
          <li><a href="../../Net/SSH/ChannelOpenFailed.html">Net::SSH::ChannelOpenFailed</a></li>
        
          <li><a href="../../Net/SSH/ChannelRequestFailed.html">Net::SSH::ChannelRequestFailed</a></li>
        
          <li><a href="../../Net/SSH/Compat.html">Net::SSH::Compat</a></li>
        
          <li><a href="../../Net/SSH/Config.html">Net::SSH::Config</a></li>
        
          <li><a href="../../Net/SSH/Connection.html">Net::SSH::Connection</a></li>
        
          <li><a href="../../Net/SSH/Connection/Channel.html">Net::SSH::Connection::Channel</a></li>
        
          <li><a href="../../Net/SSH/Connection/Constants.html">Net::SSH::Connection::Constants</a></li>
        
          <li><a href="../../Net/SSH/Connection/Session.html">Net::SSH::Connection::Session</a></li>
        
          <li><a href="../../Net/SSH/Connection/Session/NilChannel.html">Net::SSH::Connection::Session::NilChannel</a></li>
        
          <li><a href="../../Net/SSH/Connection/Term.html">Net::SSH::Connection::Term</a></li>
        
          <li><a href="../../Net/SSH/ConnectionTimeout.html">Net::SSH::ConnectionTimeout</a></li>
        
          <li><a href="../../Net/SSH/Disconnect.html">Net::SSH::Disconnect</a></li>
        
          <li><a href="../../Net/SSH/Exception.html">Net::SSH::Exception</a></li>
        
          <li><a href="../../Net/SSH/ForwardedBufferedIo.html">Net::SSH::ForwardedBufferedIo</a></li>
        
          <li><a href="../../Net/SSH/HostKeyError.html">Net::SSH::HostKeyError</a></li>
        
          <li><a href="../../Net/SSH/HostKeyMismatch.html">Net::SSH::HostKeyMismatch</a></li>
        
          <li><a href="../../Net/SSH/HostKeyUnknown.html">Net::SSH::HostKeyUnknown</a></li>
        
          <li><a href="../../Net/SSH/KeyFactory.html">Net::SSH::KeyFactory</a></li>
        
          <li><a href="../../Net/SSH/KnownHosts.html">Net::SSH::KnownHosts</a></li>
        
          <li><a href="../../Net/SSH/Loggable.html">Net::SSH::Loggable</a></li>
        
          <li><a href="../../Net/SSH/Packet.html">Net::SSH::Packet</a></li>
        
          <li><a href="../../Net/SSH/PromptMethods.html">Net::SSH::PromptMethods</a></li>
        
          <li><a href="../../Net/SSH/PromptMethods/Clear.html">Net::SSH::PromptMethods::Clear</a></li>
        
          <li><a href="../../Net/SSH/PromptMethods/Highline.html">Net::SSH::PromptMethods::Highline</a></li>
        
          <li><a href="../../Net/SSH/PromptMethods/Termios.html">Net::SSH::PromptMethods::Termios</a></li>
        
          <li><a href="../../Net/SSH/Proxy.html">Net::SSH::Proxy</a></li>
        
          <li><a href="../../Net/SSH/Proxy/Command.html">Net::SSH::Proxy::Command</a></li>
        
          <li><a href="../../Net/SSH/Proxy/ConnectError.html">Net::SSH::Proxy::ConnectError</a></li>
        
          <li><a href="../../Net/SSH/Proxy/Error.html">Net::SSH::Proxy::Error</a></li>
        
          <li><a href="../../Net/SSH/Proxy/HTTP.html">Net::SSH::Proxy::HTTP</a></li>
        
          <li><a href="../../Net/SSH/Proxy/SOCKS4.html">Net::SSH::Proxy::SOCKS4</a></li>
        
          <li><a href="../../Net/SSH/Proxy/SOCKS5.html">Net::SSH::Proxy::SOCKS5</a></li>
        
          <li><a href="../../Net/SSH/Proxy/UnauthorizedError.html">Net::SSH::Proxy::UnauthorizedError</a></li>
        
          <li><a href="../../Net/SSH/Service.html">Net::SSH::Service</a></li>
        
          <li><a href="../../Net/SSH/Service/Forward.html">Net::SSH::Service::Forward</a></li>
        
          <li><a href="../../Net/SSH/Test.html">Net::SSH::Test</a></li>
        
          <li><a href="../../Net/SSH/Test/Channel.html">Net::SSH::Test::Channel</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions.html">Net::SSH::Test::Extensions</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions/BufferedIo.html">Net::SSH::Test::Extensions::BufferedIo</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions/Channel.html">Net::SSH::Test::Extensions::Channel</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions/IO.html">Net::SSH::Test::Extensions::IO</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions/IO/ClassMethods.html">Net::SSH::Test::Extensions::IO::ClassMethods</a></li>
        
          <li><a href="../../Net/SSH/Test/Extensions/PacketStream.html">Net::SSH::Test::Extensions::PacketStream</a></li>
        
          <li><a href="../../Net/SSH/Test/Kex.html">Net::SSH::Test::Kex</a></li>
        
          <li><a href="../../Net/SSH/Test/LocalPacket.html">Net::SSH::Test::LocalPacket</a></li>
        
          <li><a href="../../Net/SSH/Test/Packet.html">Net::SSH::Test::Packet</a></li>
        
          <li><a href="../../Net/SSH/Test/RemotePacket.html">Net::SSH::Test::RemotePacket</a></li>
        
          <li><a href="../../Net/SSH/Test/Script.html">Net::SSH::Test::Script</a></li>
        
          <li><a href="../../Net/SSH/Test/Socket.html">Net::SSH::Test::Socket</a></li>
        
          <li><a href="../../Net/SSH/Transport.html">Net::SSH::Transport</a></li>
        
          <li><a href="../../Net/SSH/Transport/Algorithms.html">Net::SSH::Transport::Algorithms</a></li>
        
          <li><a href="../../Net/SSH/Transport/CTR.html">Net::SSH::Transport::CTR</a></li>
        
          <li><a href="../../Net/SSH/Transport/CipherFactory.html">Net::SSH::Transport::CipherFactory</a></li>
        
          <li><a href="../../Net/SSH/Transport/Constants.html">Net::SSH::Transport::Constants</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC.html">Net::SSH::Transport::HMAC</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/Abstract.html">Net::SSH::Transport::HMAC::Abstract</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/MD5.html">Net::SSH::Transport::HMAC::MD5</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/MD5_96.html">Net::SSH::Transport::HMAC::MD5_96</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/None.html">Net::SSH::Transport::HMAC::None</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/RIPEMD160.html">Net::SSH::Transport::HMAC::RIPEMD160</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA1.html">Net::SSH::Transport::HMAC::SHA1</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA1_96.html">Net::SSH::Transport::HMAC::SHA1_96</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA2_256.html">Net::SSH::Transport::HMAC::SHA2_256</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA2_256_96.html">Net::SSH::Transport::HMAC::SHA2_256_96</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA2_512.html">Net::SSH::Transport::HMAC::SHA2_512</a></li>
        
          <li><a href="../../Net/SSH/Transport/HMAC/SHA2_512_96.html">Net::SSH::Transport::HMAC::SHA2_512_96</a></li>
        
          <li><a href="../../Net/SSH/Transport/IdentityCipher.html">Net::SSH::Transport::IdentityCipher</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex.html">Net::SSH::Transport::Kex</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/DiffieHellmanGroup14SHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroup14SHA1</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/DiffieHellmanGroup1SHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroup1SHA1</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/DiffieHellmanGroupExchangeSHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroupExchangeSHA1</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/DiffieHellmanGroupExchangeSHA256.html">Net::SSH::Transport::Kex::DiffieHellmanGroupExchangeSHA256</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/EcdhSHA2NistP256.html">Net::SSH::Transport::Kex::EcdhSHA2NistP256</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/EcdhSHA2NistP384.html">Net::SSH::Transport::Kex::EcdhSHA2NistP384</a></li>
        
          <li><a href="../../Net/SSH/Transport/Kex/EcdhSHA2NistP521.html">Net::SSH::Transport::Kex::EcdhSHA2NistP521</a></li>
        
          <li><a href="../../Net/SSH/Transport/KeyExpander.html">Net::SSH::Transport::KeyExpander</a></li>
        
          <li><a href="../../Net/SSH/Transport/PacketStream.html">Net::SSH::Transport::PacketStream</a></li>
        
          <li><a href="../../Net/SSH/Transport/ServerVersion.html">Net::SSH::Transport::ServerVersion</a></li>
        
          <li><a href="../../Net/SSH/Transport/Session.html">Net::SSH::Transport::Session</a></li>
        
          <li><a href="../../Net/SSH/Transport/State.html">Net::SSH::Transport::State</a></li>
        
          <li><a href="../../Net/SSH/Verifiers.html">Net::SSH::Verifiers</a></li>
        
          <li><a href="../../Net/SSH/Verifiers/Lenient.html">Net::SSH::Verifiers::Lenient</a></li>
        
          <li><a href="../../Net/SSH/Verifiers/Null.html">Net::SSH::Verifiers::Null</a></li>
        
          <li><a href="../../Net/SSH/Verifiers/Secure.html">Net::SSH::Verifiers::Secure</a></li>
        
          <li><a href="../../Net/SSH/Verifiers/Strict.html">Net::SSH::Verifiers::Strict</a></li>
        
          <li><a href="../../Net/SSH/Version.html">Net::SSH::Version</a></li>
        
          <li><a href="../../OpenSSL.html">OpenSSL</a></li>
        
          <li><a href="../../OpenSSL/BN.html">OpenSSL::BN</a></li>
        
          <li><a href="../../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
        
          <li><a href="../../OpenSSL/PKey/DH.html">OpenSSL::PKey::DH</a></li>
        
          <li><a href="../../OpenSSL/PKey/DSA.html">OpenSSL::PKey::DSA</a></li>
        
          <li><a href="../../OpenSSL/PKey/EC.html">OpenSSL::PKey::EC</a></li>
        
          <li><a href="../../OpenSSL/PKey/OpenSSL.html">OpenSSL::PKey::OpenSSL</a></li>
        
          <li><a href="../../OpenSSL/PKey/OpenSSL/PKey.html">OpenSSL::PKey::OpenSSL::PKey</a></li>
        
          <li><a href="../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL</a></li>
        
          <li><a href="../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL/PKey.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL::PKey</a></li>
        
          <li><a href="../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL/PKey/ECError.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL::PKey::ECError</a></li>
        
          <li><a href="../../OpenSSL/PKey/PKey.html">OpenSSL::PKey::PKey</a></li>
        
          <li><a href="../../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          <li><a href="../../String.html">String</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Net::SSH::KeyFactory</h1>

    <div id="description" class="description">
      
<p>A factory class for returning new Key classes. It is used for obtaining <a
href="../../OpenSSL.html">OpenSSL</a> key instances via their <a
href="../SSH.html">SSH</a> names, and for loading both public and private
keys. It used used primarily by <a href="../SSH.html">Net::SSH</a> itself,
internally, and will rarely (if ever) be directly used by consumers of the
library.</p>

<pre>klass = Net::SSH::KeyFactory.get(&quot;rsa&quot;)
assert klass.is_a?(OpenSSL::PKey::RSA)

key = Net::SSH::KeyFactory.load_public_key(&quot;~/.ssh/id_dsa.pub&quot;)</pre>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="MAP">MAP</a></dt>
          
          <dd class="description"><p>Specifies the mapping of <a href="../SSH.html">SSH</a> names to <a
href="../../OpenSSL.html">OpenSSL</a> key classes.</p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="get-method" class="method-detail ">
          <a name="method-c-get"></a>

          
          <div class="method-heading">
            <span class="method-name">get</span><span
              class="method-args">(name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Fetch an <a href="../../OpenSSL.html">OpenSSL</a> key instance by its <a
href="../SSH.html">SSH</a> name. It will be a new, empty key of the given
type.</p>
            

            
            <div class="method-source-code" id="get-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/key_factory.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-constant">MAP</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- get-source -->
            
          </div>

          

          
        </div><!-- get-method -->

      
        <div id="load_data_private_key-method" class="method-detail ">
          <a name="method-c-load_data_private_key"></a>

          
          <div class="method-heading">
            <span class="method-name">load_data_private_key</span><span
              class="method-args">(data, passphrase=nil, ask_passphrase=true, filename="")</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads a private key. It will correctly determine whether the file describes
an RSA or DSA key, and will load it appropriately. The new key is returned.
If the key itself is encrypted (requiring a passphrase to use), the user
will be prompted to enter their password unless passphrase works.</p>
            

            
            <div class="method-source-code" id="load_data_private_key-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/key_factory.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_data_private_key</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">passphrase</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">ask_passphrase</span>=<span class="ruby-keyword">true</span>, <span class="ruby-identifier">filename</span>=<span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:read</span>)
    <span class="ruby-identifier">pkey_read</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">error_class</span> = <span class="ruby-constant">ArgumentError</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">pkey_read</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/-----BEGIN DSA PRIVATE KEY-----/</span>)
      <span class="ruby-identifier">key_type</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSA</span>
      <span class="ruby-identifier">error_class</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSAError</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/-----BEGIN RSA PRIVATE KEY-----/</span>)
      <span class="ruby-identifier">key_type</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">RSA</span>
      <span class="ruby-identifier">error_class</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">RSAError</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/-----BEGIN EC PRIVATE KEY-----/</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">EC</span>)
      <span class="ruby-identifier">key_type</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">EC</span>
      <span class="ruby-identifier">error_class</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">ECError</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/-----BEGIN (.+) PRIVATE KEY-----/</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>, <span class="ruby-node">&quot;not a supported key type '#{$1}'&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>, <span class="ruby-node">&quot;not a private key (#{filename})&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">encrypted_key</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/ENCRYPTED/</span>)
  <span class="ruby-identifier">tries</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">pkey_read</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">passphrase</span> <span class="ruby-operator">||</span> <span class="ruby-string">'invalid'</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">key_type</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">passphrase</span> <span class="ruby-operator">||</span> <span class="ruby-string">'invalid'</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-identifier">error_class</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">encrypted_key</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ask_passphrase</span>
      <span class="ruby-identifier">tries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">tries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
        <span class="ruby-identifier">passphrase</span> = <span class="ruby-identifier">prompt</span>(<span class="ruby-node">&quot;Enter passphrase for #{filename}:&quot;</span>, <span class="ruby-keyword">false</span>)
        <span class="ruby-keyword">retry</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">raise</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_data_private_key-source -->
            
          </div>

          

          
        </div><!-- load_data_private_key-method -->

      
        <div id="load_data_public_key-method" class="method-detail ">
          <a name="method-c-load_data_public_key"></a>

          
          <div class="method-heading">
            <span class="method-name">load_data_public_key</span><span
              class="method-args">(data, filename="")</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads a public key. It will correctly determine whether the file describes
an RSA or DSA key, and will load it appropriately. The new public key is
returned.</p>
            

            
            <div class="method-source-code" id="load_data_public_key-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/key_factory.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_data_public_key</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">filename</span>=<span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">blob</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/ /</span>)

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>, <span class="ruby-node">&quot;public key at #{filename} is not valid&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">blob</span> = <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&quot;m*&quot;</span>).<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">reader</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">blob</span>)
  <span class="ruby-identifier">reader</span>.<span class="ruby-identifier">read_key</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>, <span class="ruby-node">&quot;not a public key #{filename.inspect}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_data_public_key-source -->
            
          </div>

          

          
        </div><!-- load_data_public_key-method -->

      
        <div id="load_private_key-method" class="method-detail ">
          <a name="method-c-load_private_key"></a>

          
          <div class="method-heading">
            <span class="method-name">load_private_key</span><span
              class="method-args">(filename, passphrase=nil, ask_passphrase=true)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads a private key from a file. It will correctly determine whether the
file describes an RSA or DSA key, and will load it appropriately. The new
key is returned. If the key itself is encrypted (requiring a passphrase to
use), the user will be prompted to enter their password unless passphrase
works.</p>
            

            
            <div class="method-source-code" id="load_private_key-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/key_factory.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_private_key</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">passphrase</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">ask_passphrase</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">data</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">filename</span>))
  <span class="ruby-identifier">load_data_private_key</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">passphrase</span>, <span class="ruby-identifier">ask_passphrase</span>, <span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_private_key-source -->
            
          </div>

          

          
        </div><!-- load_private_key-method -->

      
        <div id="load_public_key-method" class="method-detail ">
          <a name="method-c-load_public_key"></a>

          
          <div class="method-heading">
            <span class="method-name">load_public_key</span><span
              class="method-args">(filename)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads a public key from a file. It will correctly determine whether the
file describes an RSA or DSA key, and will load it appropriately. The new
public key is returned.</p>
            

            
            <div class="method-source-code" id="load_public_key-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/key_factory.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_public_key</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">data</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">filename</span>))
  <span class="ruby-identifier">load_data_public_key</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_public_key-source -->
            
          </div>

          

          
        </div><!-- load_public_key-method -->

      
      </div><!-- public-class-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

